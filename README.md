# LLDM (Large Language Dungeon Master)

LLDM is an AI-powered Dungeon Master application that combines traditional RPG mechanics with modern Large Language Model (LLM) capabilities. It allows you to play a text-based RPG with a dynamic narrative generated by AI, grounded in a structured ruleset.

## Features

-   **Hybrid Gameplay**: Combines structured stats, skills, and inventory with free-form narrative.
-   **AI Narrator**: Uses Ollama (offline) or OpenRouter (online) to generate game text.
-   **NLP Interaction**: Type natural language actions (e.g., "I attack the goblin with my sword") which are parsed into game commands.
-   **Visual Interface**: A GUI with a map, character sheet, inventory, and narrative log.
-   **Moddable**: All game data (entities, rooms, rules) is defined in YAML files.

## Installation

### Prerequisites

1.  **Python 3.8+**: Ensure you have Python installed.
2.  **Ollama** (Optional, for offline mode): Download and install [Ollama](https://ollama.com/).
    *   Pull a model: `ollama pull gemma2:9b` (or your preferred model).

### Setup

1.  Clone the repository or download the source code.
2.  Install the required Python packages:
    ```bash
    pip install -r requirements.txt
    ```
    *   *Note: If `requirements.txt` is missing, install: `tk`, `PyYAML`, `sentence-transformers`, `spacy`.*
3.  Download the spaCy model:
    ```bash
    python -m spacy download en_core_web_sm
    ```

## Usage

1.  Run the application:
    ```bash
    python main.py
    ```
2.  **First Run**:
    *   The application will check for Ollama. If not found, it may prompt you to install it.
    *   You can switch between **Offline** (Ollama) and **Online** (OpenRouter) modes in the `LLM` menu.
3.  **Playing**:
    *   Use the input bar at the bottom to type your actions.
    *   Explore the map, interact with entities, and manage your inventory.

## Project Structure

*   `main.py`: Entry point of the application.
*   `classes.py`: Core data models (Entity, Room, etc.) and game logic.
*   `GUI.py`: Tkinter-based graphical user interface.
*   `nlp_processor.py`: Handles intent classification and entity recognition.
*   `llm_manager.py` & `ollama_manager.py`: Manage AI model interactions.
*   `rulesets/`: Directory containing YAML files for game content.

## Troubleshooting

*   **"sentence-transformers not found"**: Install it via pip. It is required for understanding player actions.
*   **"Ollama not found"**: Ensure Ollama is installed and running. You can check by running `ollama list` in your terminal.
*   **Slow Performance**: The first run of the NLP model might be slow as it downloads weights. Subsequent runs will be faster.
